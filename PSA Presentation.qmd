---
title: "Payment for ecosystem services as a measure for tropical dry forest conservation in Colombia" 
subtitle: "Final work presented in Economics and Enviroment course"
author:
  name: "Juan Sebastián Mendoza Páez"
  affiliation: "Forest engineering student"
format:
  revealjs:
    footer: 'Payment for ecosystem services as a measure for tropical dry forest conservation in Colombia'
    center: true
    slide-number: true
    theme: Auxiliar files/Tema.scss
    self-contained: true
    margin: 0.1
    width: 1100
css: Auxiliar files/styles.css
bibliography: Auxiliar files/references.bib
csl: Auxiliar files/apa.csl
---

## Tropical dry forest {.title}

::: font-size="10px"
It is an ecosystem characterized by:

::: incremental
-   Strong rain stationality.
-   Among 4 to 6 months per year of drought.
-   Restricted to lowlands from Mexico to Bolivia and Brazil in neotropic.
-   Physiological and morphological adaptations of plants and animals.
:::
:::

::: fragment
::: {.callout-warning appearance="simple"}
::: justify
From \~9 million of hectares of original tropical dry forest extension, today only remain around of 8%. The livestock grazing and agriculture expansion are the main drivers of deforestation.
:::
:::
:::

::: cita
[@bst_2014]
:::

## Payment for ecosystem services (PES) {.title}

::: {.justify style="font-size: 30px"}
**The ecosystem services** are the ecological characteristics, functions, or processes that directly or indirectly contribute to human wellbeing: that is, the benefits that people obtain from functioning ecosystems [@costanza2017].
:::

::: fragment
::: grid
<div>

![](Auxiliar%20files/PES.png){style="height: 380px"}

</div>

::: fragment
::: {style="text-align: center"}

::: {style="margin-top: 20px; font-size: 30px"}
**PES modalities**
:::

![](Auxiliar%20files/pes-modalities.png){style="height: 320px"}
:::
:::
:::
:::

## Objective {.title}

::: justify
To determine the Colombian towns with potential to implement a PES scheme. The town potential was established through the opportunity cost[^1] of the main farming activities in regions where the tropical dry forest is present.
:::

[^1]: The opportunity cost refers to the resources that people leave to perceive due to do not choice the best possible alternative.

## Methodology {.title}

![](Auxiliar%20files/methodology.svg)

## Results {.title}

```{r}
pacman::p_load(leaflet, leaflet.extras, tidyverse, sf, geojsonsf, formattable, sunburstR, d3r)

tree <- read.csv('resumen.csv') %>% 
  mutate(region = case_when(
    region == 'andina' ~ 'Andean',
    region == "pacifica" ~ 'Pacific',
    region == 'caribe' ~ 'Caribbean',
    region == "orinoquia" ~ 'Orinoco'), 
    c_oportunidad = case_when(
      c_oportunidad == "Bajo" ~ "Low",
      c_oportunidad == "Medio" ~ "Medium",
      c_oportunidad == "Alto" ~ "High",
      c_oportunidad == "Muy Alto" ~ "Very High") %>%
      factor(levels = c('Low', 'Medium', 'High', 'Very High')),
    actividad = case_when(
      actividad == "cultivos" ~ "Crops",
      actividad == "forestal" ~ "Forestry",
      actividad == "ganaderia" ~ "Livestock",
      actividad == "avicultura" ~ "Poultri farming"
    )) %>% 
  group_by(region, c_oportunidad) %>% 
  summarise(area = sum(area_bst)/100) %>%
  rename(level1 = 1, level2 = 2, size = 3) %>%
  d3_nest(value_cols = 'size')

sund2b(tree, width = '50%', height = 400, rootLabel = "Tropical dry forest",
       showLabels = T)
```


## Results {.title}

```{r}
regiones <- st_read('Trabajo final/Shapes.gpkg', layer = 'regiones', quiet = T)
datos <- geojson_sf('Resultados.geojson') %>% 
  mutate(c_oportunidad = case_when(
          c_oportunidad == "Bajo" ~ "Low",
          c_oportunidad == "Medio" ~ "Medium",
          c_oportunidad == "Alto" ~ "High",
          c_oportunidad == "Muy Alto" ~ "Very High") %>%
            factor(levels = c('Low', 'Medium', 'High', 'Very High')),
        actividad = case_when(
          actividad == "cultivos" ~ "Crops",
          actividad == "forestal" ~ "Forestry",
          actividad == "ganaderia" ~ "Livestock",
          actividad == "avicultura" ~ "Poultri farming"
        ))

valores <- datos$c_oportunidad %>% unique

color <- c("#ff0000", "#ff8300", "#ffbd00", "#e7f529") %>% rev
paleta <- colorFactor(palette = color, valores)

texto <- paste0(
  "<b>Region:</b> ", datos$departamento %>% str_to_title, "<br/>",
  "<b>City:</b> ", datos$municipio %>% str_to_title, "<br/>",
  "<b>Activity:</b> ", datos$actividad, "<br/>",
  "<b>Opportunity cost/ha:</b> ", formattable::currency(datos$utilidad, symbol = '$'), "<br/>",
  "<b>Classification:</b> ", datos$c_oportunidad
) %>% lapply(htmltools::HTML)

leaflet(datos, width = 520) %>%
  addProviderTiles(provider = providers$CartoDB.VoyagerNoLabels) %>%
  addPolygons(data = regiones, weight = 0.5, group = 'Regions', fillOpacity = 0.2, col = 'gray') %>%
  addPolygons(weight = 1.5, color = ~paleta(datos$c_oportunidad),
              label = texto, group = 'Opportunity cost',
              labelOptions = labelOptions(textsize = "13px")) %>%
  addLegend(pal = paleta, values = ~c_oportunidad,
            opacity = 0.5, title = 'Opportunity cost', position = "topright") %>%
  addLayersControl(overlayGroups = c('Opportunity cost', 'Regions'),
                   options = layersControlOptions(collapsed = F)) %>%
  addMiniMap(position = "bottomright", toggleDisplay = T, width = 110, height = 120)
```

## Conclusions {.title}

-   North departments of Colombia are key for the conservation of tropical dry forest.

::: incremental
-   Opportunities to improve by getting information to fine scale.
:::

## Thanks {.title}

## References {.title}

---
title: "Payment for ecosystem services as a measure for tropical dry forest conservation in Colombia" 
subtitle: "Final work presented in Economics and Enviroment course"
author:
  name: "Juan Sebastián Mendoza Páez"
  affiliation: "Forest engineering student"
format:
  revealjs:
    footer: 'Payment for ecosystem services as a measure for tropical dry forest conservation in Colombia'
    center: true
    slide-number: true
    theme: Auxiliar files/Tema.scss
    self-contained: true
    margin: 0.1
    width: 1100
css: Auxiliar files/styles.css
bibliography: Auxiliar files/references.bib
csl: Auxiliar files/apa.csl
---

## Tropical dry forest {.title}

::: font-size="10px"
It is an ecosystem characterized by:

::: incremental
-   Strong rain stationality.
-   Among 4 to 6 months per year of drought.
-   Restricted to lowlands from Mexico to Bolivia and Brazil in neotropic.
-   Physiological and morphological adaptations of plants and animals.
:::
:::

::: fragment
::: {.callout-warning appearance="simple"}
::: justify
From \~9 million of hectares of original tropical dry forest extension, today only remain around of 8%. The livestock grazing and agriculture expansion are the main drivers of deforestation.
:::
:::
:::

::: cita
[@bst_2014]
:::

## Payment for ecosystem services (PES) {.title}

:::: {.columns}

::: {.column width="40%"}
::: {.justify style="font-size: 27px"}
**The ecosystem services** are the ecological characteristics, functions, or processes that directly or indirectly contribute to human wellbeing [@costanza2017].
:::

![](Auxiliar files/services.jpg){style="height: 340px"}
:::

::: {.column width="59%"}
::: fragment
![](Auxiliar%20files/PES.png){style="height: 400px; padding-top: 50px"}
:::
:::
::::

## Objective {.title}

::: justify
Determine the Colombian towns with potential to implement a PES scheme. The town potential was established through the opportunity cost[^1] of the main farming activities in regions where the tropical dry forest is present.
:::

[^1]: Opportunity cost refers to the resources people forego by not choosing the best possible alternative. 

## Methodology {.title auto-animate=true}

:::: {.columns}

::: {.column width=20%}

![](Auxiliar files/Farming activities.svg)

![](Auxiliar files/Results.svg)

:::

::: {.column width=75%}

![](Auxiliar files/Data wrangling.svg)

:::
::::


## Methodology {.title auto-animate=true}

:::: {.columns}

::: {.column width=20%}

![](Auxiliar files/Data wrangling.svg)

![](Auxiliar files/Results.svg)

:::

::: {.column width=75%}

![](Auxiliar files/Farming activities.svg)

:::
::::

## Methodology {.title auto-animate=true}

:::: {.columns}

::: {.column width=20%}

![](Auxiliar files/Data wrangling.svg)

![](Auxiliar files/Farming activities.svg)

:::

::: {.column width=75%}

![](Auxiliar files/Results.svg)

:::
::::


## Results {.title}

::: grid

::: fragment
###### Tropical dry forest by Colombian regions

```{r}
pacman::p_load(leaflet, leaflet.extras, tidyverse, sf, geojsonsf, formattable,
               echarts4r, htmlwidgets)

data <- read.csv('resumen.csv') %>% 
  mutate(region = case_when(
    region == 'andina' ~ 'Andean',
    region == "pacifica" ~ 'Pacific',
    region == 'caribe' ~ 'Caribbean',
    region == "orinoquia" ~ 'Orinoco'), 
    c_oportunidad = case_when(
      c_oportunidad == "Bajo" ~ "Low",
      c_oportunidad == "Medio" ~ "Medium",
      c_oportunidad == "Alto" ~ "High",
      c_oportunidad == "Muy Alto" ~ "Very High") %>%
      factor(levels = c('Low', 'Medium', 'High', 'Very High')),
    actividad = case_when(
      actividad == "cultivos" ~ "Crops",
      actividad == "forestal" ~ "Forestry",
      actividad == "ganaderia" ~ "Livestock",
      actividad == "avicultura" ~ "Poultri farming"
    ))


tooltip <- JS(
'function(params) {',
  'let USDollar = new Intl.NumberFormat("en-US", {',
  '  style: "currency",',
  '  currency: "USD",',
  '})',

  'const data = [',
    '{"region":"Andean","area":4959.8889,"n":201,"low":48,"min":95.3589,"max":295.5117},',
    '{"region":"Pacific","area":387.1506,"n":55,"low":2,"min":96.4336,"max":103.4846},',
    '{"region":"Caribbean","area":1777.4974,"n":62,"low":34,"min": 103.4846,"max":257.5044},',
    '{"region":"Orinoco","area":3005.7227,"n":23,"low":0,"min": "NA","max": "NA"}]',
   
   'const inf = data.filter(obj => {return obj.region === params.name})',
   'const min = Math.round(inf[0].min)',
   'const max = Math.round(inf[0].max)',
   'return `<p style="font-size: 20px; color: black"><b>Municipalities:</b> ${inf[0].n} <br>
            <b>Low opportunity cost:</b> ${inf[0].low}<br>
            <b>Values:</b> ${inf[0].region === "Orinoco" ? "Does not apply" :
            USDollar.format(min) + " - " + USDollar.format(max)}</p>`',
'}'
)

data %>% 
  pivot_wider(names_from = c_oportunidad, values_from = municipio) %>% 
  mutate(across(.cols = 8:11, .fns = ~ifelse(is.na(.x), 0, 1))) %>%
  summarise(area = sum(area_bst)/100, .by = 'region', 
            n = n(), low = sum(Low)) %>%
  e_charts(region) %>%
  e_pie(area, name = 'Tropical dry forest', width = 550) %>%
  e_labels(show = F) %>%
  e_text_style(fontSize = 20) %>%
  e_tooltip(formatter = tooltip) %>%
  e_legend(left = 'left', orient = 'vertical', itemGap = 20, height = 800)
```
:::

::: fragment
###### Opportunity cost in Colombian tropical dry forests

```{r}
regiones <- st_read('Trabajo final/Shapes.gpkg', layer = 'regiones', quiet = T)
datos <- geojson_sf('Resultados.geojson') %>% 
  mutate(c_oportunidad = case_when(
          c_oportunidad == "Bajo" ~ "Low",
          c_oportunidad == "Medio" ~ "Medium",
          c_oportunidad == "Alto" ~ "High",
          c_oportunidad == "Muy Alto" ~ "Very High") %>%
            factor(levels = c('Low', 'Medium', 'High', 'Very High')),
        actividad = case_when(
          actividad == "cultivos" ~ "Crops",
          actividad == "forestal" ~ "Forestry",
          actividad == "ganaderia" ~ "Livestock",
          actividad == "avicultura" ~ "Poultri farming"
        ))

valores <- datos$c_oportunidad %>% unique

color <- c("#ff0000", "#ff8300", "#ffbd00", "#e7f529") %>% rev
paleta <- colorFactor(palette = color, valores)

texto <- paste0(
  "<b>Region:</b> ", datos$departamento %>% str_to_title, "<br/>",
  "<b>City:</b> ", datos$municipio %>% str_to_title, "<br/>",
  "<b>Activity:</b> ", datos$actividad, "<br/>",
  "<b>Opportunity cost/ha:</b> ", formattable::currency(datos$utilidad, symbol = '$'), "<br/>",
  "<b>Classification:</b> ", datos$c_oportunidad
) %>% lapply(htmltools::HTML)

leaflet(datos, width = 540, elementId = "mapa") %>%
  addProviderTiles(provider = providers$CartoDB.VoyagerNoLabels) %>%
  addPolygons(data = regiones, weight = 0.5, group = 'Regions', fillOpacity = 0.1, col = 'gray') %>%
  addPolygons(weight = 1.5, color = ~paleta(datos$c_oportunidad),
              label = texto, group = 'Opportunity cost',
              labelOptions = labelOptions(textsize = "13px")) %>%
  addLegend(pal = paleta, values = ~c_oportunidad,
            opacity = 0.5, title = 'Opportunity cost', position = "topright") %>%
  addLayersControl(overlayGroups = c('Opportunity cost', 'Regions'),
                   options = layersControlOptions(collapsed = F)) %>%
  addMiniMap(position = "bottomright", toggleDisplay = T, width = 100, height = 110)
```
:::

:::

## Conclusions {.title}

::: conclusions
This work is a primer approach to the areas where strategies can be focused to preserve tropical dry forest in Colombia.
:::

![](Auxiliar files/forest.jpg){style="height: 300px; width: 1500px; position: relative; top: 15vh"}

## Thanks {.title}

## References {.title}
